/**
 * skylark-langx-events - The skylark JavaScript language extension library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event","./Listener"],function(t,n,i,e,r,a,s){var o=Array.prototype.slice,h=i.compact,u=t.isDefined,f=t.isPlainObject,l=t.isFunction,c=t.isString,p=(t.isEmptyObject,n.mixin);n.safeMixin;function d(t){var n=(""+t).split(".");return{name:n[0],ns:n.slice(1).join(" ")}}var v=s.inherit({_prepareArgs:function(t,n){return n=u(n)?[t].concat(n):[t]},on:function(t,n,i,e,r,a){var s=this,o=this._hub||(this._hub={});if(f(t))return r=e,each(t,function(t,e){s.on(t,n,i,e,r,a)}),this;if(c(n)||l(e)||(r=e,e=i,i=n,n=void 0),l(i)&&(r=e,e=i,i=null),!e)throw new Error("No callback function");if(!l(e))throw new Error("The callback  is not afunction");return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var s=d(t),h=s.name,u=s.ns;(o[h]||(o[h]=[])).push({fn:e,selector:n,data:i,ctx:r,ns:u,one:a})}),this},one:function(t,n,i,e,r){return this.on(t,n,i,e,r,1)},emit:function(t){if(!this._hub)return this;var n=this;c(t)&&(t=new a(t)),Object.defineProperty(t,"target",{value:this});var i=o.call(arguments,1);return i=this._prepareArgs(t,i),[t.type||t.name,"all"].forEach(function(e){var r=d(e),a=r.name,s=r.ns,o=n._hub[a];if(o){for(var u=o.length,l=!1,c=0;c<u;c++){if(t.isImmediatePropagationStopped&&t.isImmediatePropagationStopped())return this;var v=o[c];(!s||v.ns&&v.ns.startsWith(s))&&(v.data&&(t.data=p({},v.data,t.data)),2==i.length&&f(i[1])&&(t.data=t.data||{},p(t.data,i[1])),v.fn.apply(v.ctx,i),v.one&&(o[c]=null,l=!0))}l&&(n._hub[e]=h(o))}}),this},listened:function(t){return((this._hub||(this._events={}))[t]||[]).length>0},off:function(t,n){if(t){var i=this._hub||(this._hub={});return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var e=d(t),r=e.name,a=e.ns,s=i[r];if(s){var o=[];if(n||a)for(var h=0,u=s.length;h<u;h++)n&&s[h].fn!==n&&s[h].fn._!==n?o.push(s[h]):!a||s[h].ns&&0==s[h].ns.indexOf(a)||o.push(s[h]);o.length?i[r]=o:delete i[r]}}),this}this._hub=null},trigger:function(){return this.emit.apply(this,arguments)}});return r.Emitter=v});
//# sourceMappingURL=sourcemaps/Emitter.js.map
